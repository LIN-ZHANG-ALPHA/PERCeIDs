README

========== 0. INTRODUCTION

SMF is a seasonality and drift aware matrix factorization algorithm. It takes in a series of sparse matrices, A(1), ..., A(r), and forecasts future data, and also detects anomalies.

SMF consists of 3 main functions:

- smf: for fitting the model
- forecast_smf: fits the model and forecasts it for a given number of time steps

========== 1. GETTING STARTED

The easiest way to get started is to run main_sample.m. This fits SMF on the accompanying sample data (data/taxi_sample.csv), and creates plots of the output.

The format of data/taxi_sample.csv is: each line is of the form 

"origin destination time count"

This represents that there were *count* taxi trips from *origin* to *destination* at time *time*.

========== 3. FUNCTION REFERENCE: INPUT/OUTPUT

(a) smf

INPUT:
- T: m x n x r input tensor
- TL: list form of T (create this by running tensor2list on T)
- k: number of components
- s: period (e.g. 7 for daily data with weekly seasonality)
- alpha: learning rate
- init_cycles: number of seasons to use for initialization (3 is
recommended)
- output_anom: pass in true to output anomaly detection results, which is
the matrix E

OUTPUT:
- U: a cell array with 2 components: U{1} is an m x k matrix which is the
1st component, while U{2} is a n x k matrix which is the 2nd component.
These correspond to U and V from the paper.
- W: r by k matrix of seasonal multipliers (corresponding to W in the
paper). W(t,:) is the vector of seasonal multipliers at time t.
- E: anomaly detection output. E(i,t) is the anomalousness of entity i in
the first mode at time t. (to investigate the 2nd mode, just transpose
the input tensor to swap mode 1 and 2)

(b) forecast_smf

INPUT:
- T: m x n x r input tensor
- TL: list form of T (create this by running tensor2list on T)
- forecast_steps: number of time steps ahead to forecast
- k: number of components
- s: period (e.g. 7 for daily data with weekly seasonality)
- alpha: learning rate
- init_cycles: number of seasons to use for initialization (3 is
recommended)

OUTPUT:
- Tpred: tensor containing our predictions, of size m x n x forecast_steps. 
- U: a cell array with 2 components: U{1} is an m x k matrix which is the
1st component, while U{2} is a n x k matrix which is the 2nd component.
These correspond to U and V from the paper.
- W: r by k matrix of seasonal multipliers (corresponding to W in the
paper). W(t,:) is the vector of seasonal multipliers at time t.

========== 4. UTILITY FUNCTIONS

tensor2list and list2tensor convert back and forth between the usual 3-way tensor format (i.e. m x n x r input tensor) and the tensor list format (a list of m x n matrices of length r). 
